Mediawiki Installation on AWS using Terraform & Ansible
------------------------------------------------------- 

Assumptions/Pre-Requisites: 
---------------------------
1. Terraform is installed and the PATH is set. 
	
	If not, download the setup using the instructions in the link below: 
	https://www.terraform.io/intro/getting-started/install.html
	1. Download the zip file
	2. unzip the file
	3. move the file to /usr/local/bin/
	4. check using "terraform --version" command
	
2. AWS Secret variables are set: 
	
	AWS_ACCESS_KEY_ID='****'
	AWS_SECRET_ACCESS_KEY='***'
	
3. Python 2.7+ and Ansible 2.x is installed
	
   Step 1 — Installing Ansible
   
   sudo yum install epel-release
   sudo yum install ansible
   
   Step 2 — Configuring Ansible Hosts
   Below are the reference to configure Dynamic Inventory in Ansible for AWS (/etc/ansible/hosts will not be used in AWS since the instances are dynamic)
   
   https://devopscube.com/setup-ansible-aws-dynamic-inventory/#:~:text=Dynamic%20inventory%20is%20an%20ansible,was%20just%20a%20Python%20file.
   
   https://medium.com/@rakeshguha15/how-to-use-ansible-aws-ec2-plugin-to-create-dynamic-inventory-7098553d160
   
AWS Resources
--------------
 - Terraform that does the following:
 	- 1 VPC
 	- 3 Subnets  
 	- 1 Keypair 
 	- 3 EC2 Instances - 2 Web and 1 DB
 	- 1 Elastic Load Balancer
	- Launch Confguration
	- Autoscaling
	- Provisioner (Used to run ansible playbook)
   
 - Ansible Playbook that performs the following: 
    - Dynamically fetches your resources based on the tags you defined in the terraform IaC. 
    - Performs the Installation of the MySQL Database
    - Creates the Database and Users and other Validations. 
    - Encrypts the passwords into a vault. 
    - Role that installs Apache HTTPD, PHP from third-party repositories (remi, epel)
    - Configures the webserver
    - Makes it ready for the Launch on the browser. 

Steps to setup
---------------
1. Clone and switch the directory to the Repository. 

2. Navigate to the folder: 

    cd terraform

3. Initialize the working directory.:

    terraform init
	
4. Create a plan and save it to the local file tfplan: 

	terraform plan -out=tfplan
	
5. Apply the plan stored in the file tfplan.
	terraform apply -input=false tfplan -auto-approve
	
6. Below output autogenerated
   1. Instance IDs with public IP
   2. Private key to login to the instance created 
   3. ELB DNS Name
	
7. Open the Browser and check the URL with mediawiki page
